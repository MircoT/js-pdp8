ORG 42
BSA MMA
HEAD, VECTOR
LEN, DEC 7 
MAX, DEC 0
MIN, DEC 0
AVG, DEC 0
HLT

MMA, HEX 0
LDA MMA I
STA CUR
ISZ MMA
LDA MMA I
STA IN_Y
CMA
INC
STA _LEN
ISZ MMA
BUN LOOP
CUR, HEX 0
_LEN, DEC 0
_MAX, DEC -32768
_MIN, DEC 32767
_SUM, DEC 0

LOOP, LDA _SUM
ADD CUR I
STA _SUM

// Check MAX
LDA CUR I 
CMA
INC
ADD _MAX
SNA

BUN CHECK_MAX
LDA CUR I
STA _MAX

CHECK_MAX, SZE
BUN NEW_MAX
BUN BRANCH_MIN
NEW_MAX, LDA CUR I
STA _MAX

// Check MIN
BRANCH_MIN, CLA
CLE
LDA CUR I 
CMA
INC
ADD _MIN
SPA

BUN CHECK_MIN
LDA CUR I
STA _MIN

CHECK_MIN, SZE
BUN NEW_MIN
BUN NEXT
NEW_MIN, LDA CUR I
STA _MIN

NEXT, ISZ CUR
ISZ _LEN
BUN LOOP

CLA
CLE

LDA _MAX
STA MMA I
ISZ MMA
LDA _MIN
STA MMA I
ISZ MMA

CLA
CLE
LDA _SUM
STA IN_X
BSA DIV
IN_X, DEC 0
IN_Y, DEC 0
OUT_DIV, DEC 0
LDA OUT_DIV
STA MMA I
ISZ MMA
BUN MMA I

DIV,HEX 0
CLA
CLE
BUN START
X, DEC 0
Y, DEC 0
RIS, DEC -1
START, LDA DIV I
STA X
ISZ DIV
LDA DIV I
CMA
INC
STA Y
ISZ DIV
LDA X

DIV_LOOP, ADD Y
ISZ RIS
SNA
BUN DIV_LOOP

LDA RIS
STA DIV I
ISZ DIV
BUN DIV I

VECTOR, DEC 1
DEC 5
DEC 88
DEC 7
DEC 21
DEC -16
DEC 99
END